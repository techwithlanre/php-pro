{
  "scopeName": "source.php",
  "fileTypes": ["php", "phtml"],
  "name": "PHP Enhanced Pro",
  "patterns": [{ "include": "#php-embedded" }, { "include": "#html" }],
  "repository": {
    "html": {
      "patterns": [{ "include": "text.html.basic" }]
    },
    "php-embedded": {
      "patterns": [{
        "name": "meta.embedded.block.php",
        "begin": "(<\\?)(php|=)?",
        "beginCaptures": {
          "1": { "name": "punctuation.section.embedded.begin.php" },
          "2": { "name": "keyword.other.php" }
        },
        "end": "\\?>",
        "endCaptures": {
          "0": { "name": "punctuation.section.embedded.end.php" }
        },
        "patterns": [{ "include": "#php-code" }]
      }]
    },
    "php-code": {
      "patterns": [
        { "include": "#comments" },
        { "include": "#attributes" },
        { "include": "#heredoc" },
        { "include": "#strings" },
        { "include": "#numbers" },
        { "include": "#keywords" },
        { "include": "#definitions" },
        { "include": "#function-calls" },
        { "include": "#variables" },
        { "include": "#constants" },
        { "include": "#operators" },
        { "include": "#punctuation" }
      ]
    },
    "comments": {
      "patterns": [
        {
          "name": "comment.block.documentation.phpdoc.php",
          "begin": "/\\*\\*",
          "end": "\\*/",
          "patterns": [
            {
              "name": "meta.inline.phpdoc.php",
              "begin": "\\{@",
              "beginCaptures": {
                "0": { "name": "punctuation.definition.inline.phpdoc.php" }
              },
              "end": "\\}",
              "endCaptures": {
                "0": { "name": "punctuation.definition.inline.phpdoc.php" }
              },
              "patterns": [
                { "name": "keyword.other.phpdoc.php", "match": "^[A-Za-z_][\\w-]*" },
                { "name": "entity.name.type.phpdoc.php", "match": "(?:\\\\)?[A-Za-z_\\x80-\\xff][\\\\\\w\\x80-\\xff]*" },
                { "name": "variable.other.phpdoc.php", "match": "\\$[A-Za-z_\\x80-\\xff][\\w\\x80-\\xff]*" },
                { "name": "punctuation.separator.phpdoc.php", "match": "[,|&<>\\[\\]()?:]" }
              ]
            },
            {
              "name": "meta.phpdoc.param.php",
              "match": "(\\B@(param|phpstan-param|psalm-param))\\s+([^\\s]+)\\s+(\\$[A-Za-z_\\x80-\\xff][\\w\\x80-\\xff]*)",
              "captures": {
                "1": { "name": "keyword.other.phpdoc.php" },
                "3": { "name": "storage.type.phpdoc.php" },
                "4": { "name": "variable.other.phpdoc.php" }
              }
            },
            {
              "name": "meta.phpdoc.var.php",
              "match": "(\\B@(var|phpstan-var|psalm-var))\\s+([^\\s]+)(?:\\s+(\\$[A-Za-z_\\x80-\\xff][\\w\\x80-\\xff]*))?",
              "captures": {
                "1": { "name": "keyword.other.phpdoc.php" },
                "3": { "name": "storage.type.phpdoc.php" },
                "4": { "name": "variable.other.phpdoc.php" }
              }
            },
            {
              "name": "meta.phpdoc.return.php",
              "match": "(\\B@(return|phpstan-return|psalm-return))\\s+([^\\s]+)",
              "captures": {
                "1": { "name": "keyword.other.phpdoc.php" },
                "3": { "name": "storage.type.phpdoc.php" }
              }
            },
            {
              "name": "meta.phpdoc.throws.php",
              "match": "(\\B@(throws|exception))\\s+([^\\s]+)",
              "captures": {
                "1": { "name": "keyword.other.phpdoc.php" },
                "3": { "name": "entity.name.type.phpdoc.php" }
              }
            },
            {
              "name": "meta.phpdoc.property.php",
              "match": "(\\B@(property|property-read|property-write))\\s+([^\\s]+)\\s+(\\$[A-Za-z_\\x80-\\xff][\\w\\x80-\\xff]*)",
              "captures": {
                "1": { "name": "keyword.other.phpdoc.php" },
                "3": { "name": "storage.type.phpdoc.php" },
                "4": { "name": "variable.other.phpdoc.php" }
              }
            },
            {
              "name": "meta.phpdoc.method.php",
              "match": "(\\B@method)\\s+(?:static\\s+)?(?:([^\\s(]+)\\s+)?([A-Za-z_\\x80-\\xff][\\w\\x80-\\xff]*)\\s*\\(",
              "captures": {
                "1": { "name": "keyword.other.phpdoc.php" },
                "2": { "name": "storage.type.phpdoc.php" },
                "3": { "name": "entity.name.function.phpdoc.php" }
              }
            },
            { "name": "entity.name.type.doctrine.phpdoc.php", "match": "\\B@ORM\\\\[A-Za-z_\\x80-\\xff][\\\\\\w\\x80-\\xff]*" },
            { "name": "entity.name.type.doctrine.phpdoc.php", "match": "\\B@(Entity|Table|Column|Id|GeneratedValue|SequenceGenerator|CustomIdGenerator|ManyToOne|OneToMany|OneToOne|ManyToMany|JoinColumn|JoinColumns|JoinTable|Embeddable|Embedded|MappedSuperclass|InheritanceType|DiscriminatorColumn|DiscriminatorMap|UniqueConstraint|Index|OrderBy|HasLifecycleCallbacks|PrePersist|PostPersist|PreUpdate|PostUpdate|PreRemove|PostRemove|PostLoad|Version|Cache|ChangeTrackingPolicy)\\b" },
            { "name": "keyword.other.phpdoc.php", "match": "\\B@[A-Za-z_][\\w-]*" },
            { "name": "entity.name.type.phpdoc.php", "match": "(?:\\\\)?[A-Za-z_\\x80-\\xff][\\\\\\w\\x80-\\xff]*" },
            { "name": "constant.numeric.phpdoc.php", "match": "\\b\\d+\\b" },
            { "name": "variable.other.phpdoc.php", "match": "\\B\\$[A-Za-z_\\x80-\\xff][\\w\\x80-\\xff]*" },
            { "name": "punctuation.separator.phpdoc.php", "match": "[,|&<>\\[\\]()?:]" }
          ]
        },
        { "name": "comment.line.double-slash.php", "match": "//.*$" },
        { "name": "comment.line.number-sign.php", "match": "#.*$" },
        { "name": "comment.block.php", "begin": "/\\*", "end": "\\*/" }
      ]
    },
    "attributes": {
      "patterns": [
        {
          "name": "meta.attribute.php",
          "begin": "#\\[",
          "beginCaptures": {
            "0": { "name": "punctuation.definition.annotation.begin.php" }
          },
          "end": "\\]",
          "endCaptures": {
            "0": { "name": "punctuation.definition.annotation.end.php" }
          },
          "patterns": [
            { "name": "entity.name.type.doctrine.attribute.php", "match": "(?:\\\\)?ORM\\\\[A-Za-z_\\x80-\\xff][\\\\\\w\\x80-\\xff]*" },
            { "include": "#strings" },
            { "include": "#numbers" },
            { "include": "#constants" },
            { "include": "#variables" },
            { "include": "#operators" },
            { "include": "#punctuation" }
          ]
        }
      ]
    },
    "heredoc": {
      "patterns": [
        {
          "name": "string.unquoted.heredoc.php",
          "begin": "<<<\\s*([A-Za-z_][A-Za-z0-9_]*)\\b",
          "beginCaptures": {
            "0": { "name": "keyword.operator.heredoc.php" },
            "1": { "name": "entity.name.tag.heredoc.php" }
          },
          "end": "^\\s*\\1;?\\s*$",
          "patterns": [
            { "name": "constant.character.escape.php", "match": "\\\\." },
            { "include": "#string-interpolation" }
          ]
        },
        {
          "name": "string.unquoted.nowdoc.php",
          "begin": "<<<\\s*'([A-Za-z_][A-Za-z0-9_]*)'\\b",
          "beginCaptures": {
            "0": { "name": "keyword.operator.nowdoc.php" },
            "1": { "name": "entity.name.tag.nowdoc.php" }
          },
          "end": "^\\s*\\1;?\\s*$"
        }
      ]
    },
    "strings": {
      "patterns": [
        {
          "name": "string.quoted.other.backtick.php",
          "begin": "`",
          "end": "`",
          "patterns": [
            { "name": "constant.character.escape.php", "match": "\\\\." },
            { "include": "#string-interpolation" }
          ]
        },
        {
          "name": "string.quoted.double.php",
          "begin": "\"",
          "end": "\"",
          "patterns": [
            { "name": "constant.character.escape.php", "match": "\\\\." },
            { "include": "#string-interpolation" }
          ]
        },
        {
          "name": "string.quoted.single.php",
          "begin": "'",
          "end": "'",
          "patterns": [{ "name": "constant.character.escape.php", "match": "\\\\[\\\\']" }]
        }
      ]
    },
    "string-interpolation": {
      "patterns": [
        { "name": "variable.other.php", "match": "\\$[A-Za-z_\\x80-\\xff][\\w\\x80-\\xff]*" },
        { "name": "variable.other.php", "match": "\\{\\$[A-Za-z_\\x80-\\xff][\\w\\x80-\\xff]*\\}" },
        { "name": "constant.other.php", "match": "\\$\\{\\s*[A-Za-z_\\x80-\\xff][\\w\\x80-\\xff]*\\s*\\}" }
      ]
    },
    "numbers": {
      "patterns": [
        { "name": "constant.numeric.hex.php", "match": "\\b0[xX][0-9A-Fa-f_]+\\b" },
        { "name": "constant.numeric.binary.php", "match": "\\b0[bB][01_]+\\b" },
        { "name": "constant.numeric.octal.php", "match": "\\b0[oO][0-7_]+\\b" },
        { "name": "constant.numeric.float.php", "match": "\\b\\d[\\d_]*\\.\\d[\\d_]*(?:[eE][+-]?\\d[\\d_]*)?\\b" },
        { "name": "constant.numeric.float.php", "match": "\\b\\d[\\d_]*(?:[eE][+-]?\\d[\\d_]*)\\b" },
        { "name": "constant.numeric.integer.php", "match": "\\b\\d[\\d_]*\\b" }
      ]
    },
    "keywords": {
      "patterns": [
        {
          "name": "keyword.control.php",
          "match": "\\b(if|else|elseif|endif|switch|case|default|endswitch|for|foreach|endfor|endforeach|while|endwhile|do|break|continue|return|yield|try|catch|finally|throw|goto|declare|enddeclare|include|include_once|require|require_once|exit|die|match)\\b"
        },
        {
          "name": "keyword.control.php",
          "match": "\\b(yield)\\b\\s+(from)\\b",
          "captures": {
            "1": { "name": "keyword.control.php" },
            "2": { "name": "keyword.control.php" }
          }
        },
        {
          "name": "storage.type.php",
          "match": "\\b(class|interface|trait|enum|function|fn|namespace|use|extends|implements)\\b"
        },
        {
          "name": "storage.modifier.php",
          "match": "\\b(public|private|protected|static|abstract|final|readonly)\\b"
        },
        {
          "name": "storage.type.scalar.php",
          "match": "\\b(bool|boolean|int|integer|float|double|string|array|object|mixed|void|never|iterable|callable|self|parent|static)\\b"
        },
        {
          "name": "keyword.operator.logical.php",
          "match": "\\b(and|or|xor|instanceof|new|clone)\\b"
        }
      ]
    },
    "definitions": {
      "patterns": [
        {
          "name": "meta.definition.namespace.php",
          "match": "\\b(namespace)\\s+([\\\\A-Za-z_\\x80-\\xff][\\\\\\w\\x80-\\xff]*)",
          "captures": {
            "1": { "name": "keyword.other.namespace.php" },
            "2": { "name": "entity.name.namespace.php" }
          }
        },
        {
          "name": "meta.use.php",
          "match": "\\b(use)\\s+([\\\\A-Za-z_\\x80-\\xff][\\\\\\w\\x80-\\xff]*)",
          "captures": {
            "1": { "name": "keyword.other.use.php" },
            "2": { "name": "entity.name.namespace.php" }
          }
        },
        {
          "name": "meta.definition.class.php",
          "match": "\\b(class|interface|trait|enum)\\s+([A-Za-z_\\x80-\\xff][\\w\\x80-\\xff]*)",
          "captures": {
            "1": { "name": "storage.type.php" },
            "2": { "name": "entity.name.type.php" }
          }
        },
        {
          "name": "meta.definition.function.php",
          "match": "\\b(function)\\s+(&\\s*)?([A-Za-z_\\x80-\\xff][\\w\\x80-\\xff]*)\\b",
          "captures": {
            "1": { "name": "storage.type.php" },
            "2": { "name": "keyword.operator.php" },
            "3": { "name": "entity.name.function.php" }
          }
        }
      ]
    },
    "function-calls": {
      "patterns": [
        {
          "name": "meta.function-call.php",
          "match": "\\b([A-Za-z_\\x80-\\xff][\\w\\x80-\\xff]*)\\s*(?=\\()",
          "captures": {
            "1": { "name": "entity.name.function.call.php" }
          }
        }
      ]
    },
    "variables": {
      "patterns": [
        { "name": "variable.language.this.php", "match": "\\$this\\b" },
        { "name": "variable.other.superglobal.php", "match": "\\$(GLOBALS|_SERVER|_GET|_POST|_FILES|_COOKIE|_SESSION|_REQUEST|_ENV)\\b" },
        {
          "name": "meta.property-access.php",
          "match": "(\\$[A-Za-z_\\x80-\\xff][\\w\\x80-\\xff]*)(\\s*)(->)(\\s*)([A-Za-z_\\x80-\\xff][\\w\\x80-\\xff]*)",
          "captures": {
            "1": { "name": "variable.other.php" },
            "3": { "name": "punctuation.accessor.php" },
            "5": { "name": "variable.other.property.php" }
          }
        },
        {
          "name": "meta.static-access.php",
          "match": "([A-Za-z_\\x80-\\xff][\\w\\x80-\\xff]*)(\\s*)(::)(\\s*)([A-Za-z_\\x80-\\xff][\\w\\x80-\\xff]*)",
          "captures": {
            "1": { "name": "entity.name.type.php" },
            "3": { "name": "punctuation.accessor.php" },
            "5": { "name": "variable.other.constant.php" }
          }
        },
        { "name": "variable.other.php", "match": "\\$\\{[^}]+\\}" },
        { "name": "variable.other.php", "match": "\\$[A-Za-z_\\x80-\\xff][\\w\\x80-\\xff]*" }
      ]
    },
    "constants": {
      "patterns": [
        { "name": "constant.language.php", "match": "\\b(true|false|null|TRUE|FALSE|NULL)\\b" },
        { "name": "constant.language.php", "match": "\\b(__LINE__|__FILE__|__DIR__|__FUNCTION__|__CLASS__|__TRAIT__|__METHOD__|__NAMESPACE__)\\b" },
        { "name": "constant.other.php", "match": "\\b([A-Z_][A-Z0-9_]*)\\b" }
      ]
    },
    "operators": {
      "patterns": [
        { "name": "keyword.operator.php", "match": "\\?\\?|\\?->|=>|->|::" },
        { "name": "keyword.operator.php", "match": "===|!==|==|!=|<=|>=|<>|<=>|<|>" },
        { "name": "keyword.operator.php", "match": "\\+\\+|--|\\+|-|\\*\\*|\\*|/|%|\\." },
        { "name": "keyword.operator.php", "match": "<<|>>|&|\\||\\^|~" },
        { "name": "keyword.operator.php", "match": "&&|\\|\\||!" },
        { "name": "keyword.operator.assignment.php", "match": "=|\\+=|-=|\\*=|/=|%=|\\.=|\\*\\*=|&=|\\|=|\\^=|<<=|>>=|\\?\\?=" },
        { "name": "keyword.operator.ternary.php", "match": "\\?|:" }
      ]
    },
    "punctuation": {
      "patterns": [
        { "name": "punctuation.terminator.statement.php", "match": ";" },
        { "name": "punctuation.separator.comma.php", "match": "," },
        { "name": "punctuation.section.group.begin.php", "match": "\\(" },
        { "name": "punctuation.section.group.end.php", "match": "\\)" },
        { "name": "punctuation.section.block.begin.php", "match": "\\{" },
        { "name": "punctuation.section.block.end.php", "match": "\\}" },
        { "name": "punctuation.section.array.begin.php", "match": "\\[" },
        { "name": "punctuation.section.array.end.php", "match": "\\]" }
      ]
    }
  }
}
